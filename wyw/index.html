<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>指定文言經典精編</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://releases.jquery.com/git/jquery-git.js"></script>
    <style type="text/css">
        * {
            padding: 0;
            margin: 0;
            font-family: 'Roboto', Helvetica, Arial, sans-serif;
        }

        .none {
            display: none;
        }

        header {
            height: 5rem;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.65) 0%, transparent 120%);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        header>button.head_tools {
            margin: .5rem;
            padding: .5rem;
        }

        header>nav>* {
            display: flex;
            flex-wrap: wrap;
        }

        .article_list {
            position: relative;
            display: flex;
            flex-wrap: wrap;
        }

        .article_list>a {
            font-size: 1.375rem;
            font-weight: 400;
            text-align: center;
            border-width: 0.0625rem;
            border-style: solid;
            border-color: #dadce0;
            -webkit-border-radius: 0.5rem;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1rem;
        }

        .article_list>a:hover {
            box-shadow: 0 1px 2px 0 rgb(60 64 67 / 30%), 0 2px 6px 2px rgb(60 64 67 / 15%);
        }

        .title>h1 {
            text-align: center;
        }

        .title>.author {
            display: flex;
            justify-content: flex-end;
        }

        .passage_header {
            display: flex;
            justify-content: space-between;
        }

        .btn_relate {
            /* background-image: url('https://ssl.gstatic.com/docs/common/viewer/v3/v-sprite38.svg')!important;
            background-position: 0 -1784px;
            background-repeat: no-repeat; */
            background: none;
            border: none;
            border-radius: .5rem;
            cursor: pointer;
            outline: none;
            padding: 0 .5rem;
            /* width: 24px;
            height: 24px; */
        }

        .btn_relate:hover {
            background-color: rgba(128, 128, 128, 0.39);
        }

        .btn_relate>svg {
            width: 100%;
            height: 100%;
        }

        .sentences {
            display: flex;
            justify-content: space-around;
        }

        .sentences>div {
            padding: 1rem;
        }

        .sentences .span_hover {
            background-color: rgb(153, 205, 50);
        }

        .sentences>.original span[data-mean] {
            position: relative;
            color: rgb(255, 56, 56);
        }

        .sentences>.original span[data-mean]:hover {
            background-color: rgb(157, 230, 255);
        }

        .sentences>.original span[data-mean]:hover::after {
            position: absolute;
            color: rgb(255, 255, 255);
            display: inline-block;
            z-index: 100;
            content: attr(data-mean);
            text-align: center;
            word-break: keep-all;
            left: -1rem;
            bottom: 100%;
            margin-bottom: 6px;
            padding: .5em .75em;
            border-radius: 6px;
            background-color: gray;
        }

        .sentences>.original span[data-mean]:hover::before {
            position: absolute;
            color: rgb(255, 255, 255);
            display: inline-block;
            z-index: 100;
            content: "";
            border: 6px solid transparent;
            top: -7px;
            right: 50%;
            margin-right: -6px;
            border-top-color: gray;
        }

        /* ############################### */
        footer {
            bottom: 0;
            width: 100%;
            color: rgba(255, 255, 255, 1);
            background-color: rgba(0, 0, 0, 1);
            text-align: center;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }

        footer a {
            color: white;
        }

        footer>div {
            padding: 10px;
        }

        footer>div.Feedback>textarea {
            width: 100%;
            height: 5rem;
            grid-row: span;
        }

        footer>div.Feedback>.SendFeedback {
            cursor: pointer;
            margin: 0 auto;
            height: 24px;
            width: 24px;
            padding: 8px;
            border-width: 0;
            border-radius: 0.5em;
            background-repeat: no-repeat;
            /* background-size: cover; */
            background-image: url('https://ssl.gstatic.com/docs/common/viewer/v3/v-sprite38.svg');
            background-position: 0 -3242px;
            background-position-x: center;
        }

        footer>div.Feedback>.SendFeedback:hover {
            background-color: rgba(255, 255, 255, 0.25);
        }

        /* footer>div.Feedback>.SendFeedback:active {
            background-position: 0 -3242px;
        } */
    </style>
</head>

<body>
    <header>
        <button class="head_tools">
            <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true"
                class="octicon octicon-three-bars">
                <path fill-rule="evenodd"
                    d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
                </path>
            </svg>
        </button>
        <h1 class="page_title">指定文言經典精編</h1>
        <nav class="none">
            <div class="none">
                <svg class="Q6yead QJZfhe " width="24" height="24" viewBox="0 0 24 24" focusable="false"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"></path></svg>
                <span>深淺色切換</span>
            </div>
            <a title="出師表" href="出師表.pdf">出师表</a>
            <a title="登樓" href="登樓.pdf">登樓</a>
            <a title="廉頗藺相如列傳（節錄）" href="廉頗藺相如列傳（節錄）.pdf">廉頗藺相如列傳（節錄）</a>
            <a title="六國論" href="六國論.pdf">六國論</a>
            <a title="論仁、論孝、論君子" href="論仁、論孝、論君子.pdf">論仁、論孝、論君子</a>
            <a title="念奴嬌·赤壁懷古（大江東去）" href="念奴嬌·赤壁懷古（大江東去）.pdf">念奴嬌·赤壁懷古（大江東去）</a>
            <a title="青玉案·元夕" href="青玉案·元夕.pdf">青玉案·元夕</a>
            <a title="勸學（節錄）" href="勸學（節錄）.pdf">勸學（節錄）</a>
            <a title="山居秋暝" href="山居秋暝.pdf">山居秋暝</a>
            <a title="聲聲慢·秋情（尋尋覓覓）" href="聲聲慢·秋情（尋尋覓覓）.pdf">聲聲慢·秋情（尋尋覓覓）</a>
            <a title="師說" href="師說.pdf">師說</a>
            <a title="始得西山宴遊記" href="始得西山宴遊記.pdf">始得西山宴遊記</a>
            <a title="逍遙遊（節錄）" href="逍遙遊（節錄）.pdf">逍遙遊（節錄）</a>
            <a title="魚我所欲也" href="魚我所欲也.pdf">魚我所欲也</a>
            <a title="月下獨酌（其一）" href="月下獨酌（其一）.pdf">月下獨酌（其一）</a>
            <a title="岳陽樓記" href="岳陽樓記.pdf">岳陽樓記</a>
        </nav>
    </header>
    <main>
        <div class="article_list"></div>
        <!-- <div class="article none">
            <div class="title">
                <h1 id="逍遙遊(節錄)">逍遙遊(節錄)</h1>
                <span class="author">莊子</span>
            </div>
            <div class="paragraphs">
                <div class="passage">
                    <div class="passage_header">
                        <span class="paragraphs_subtitle"></span>
                        <button class="btn_relate">相關内容</button>
                    </div>
                    <div class="sentences">
                        <div class="original">
                            <span data-sentence="1-1">惠子謂莊子曰：「</span>
                        </div>
                        <div class="translation">
                            <span data-sentence="1-1">惠施對莊子說：「 </span>
                        </div>
                    </div>
                </div>
                <div class="related">
                    <div class="relate_tools">
                        <button class="none"></button>
                    </div>
                    <div class="relate_content"></div>
                </div>
            </div>
        </div> -->
    </main>
    <footer>
        <div title="資料來源" class="Source">
            <strong>資料來源</strong><br>
            原文:<a
                href="https://www.edb.gov.hk/tc/curriculum-development/kla/chi-edu/nss-lang/settext-reference.html">指定文言經典學習材料教師參考資料選編</a><br>
            譯文:牛津大學出版社•文言選讀•課文語譯<a href="#"></a><br>
            字譯:<a
                href="https://www.edb.gov.hk/tc/curriculum-development/kla/chi-edu/nss-lang/settext-reference.html">指定文言經典學習材料教師參考資料選編</a><br>
            主旨:<a
                href="https://www.edb.gov.hk/tc/curriculum-development/kla/chi-edu/nss-lang/settext-reference.html">指定文言經典學習材料教師參考資料選編</a><br>
            作法:啓思出版社•指定文言經典精編<a href="#"></a><br>
            題庫:<a href="https://dsepp.com/resource_centre/chinese/">DSEPP</a><br>
        </div>
        <div title="反饋" class="Feedback">
            <strong>反饋</strong><br>
            <textarea placeholder="我有疑問關於..."></textarea>
            <div class="SendFeedback" title="發送反饋"></div>
        </div>
        <div class="LastUpDate">
            最後更新時間: 2021/09/12
        </div>
    </footer>
    <script type="text/javascript" charset="utf-8">
        // get md file and import
        function getdata(url = 'https://ldwise.github.io/web/wyw/index.md') {
            // read text from URL location
            const request = new XMLHttpRequest();
            request.addEventListener("load", function () {
                if (request["readyState"] === 4 && request["status"] === 200) {
                    console.log('XMLHttpRequest is Done!');
                };
            });
            request.open('GET', url, false);
            request.send();
            return request["responseText"];
        };
        // build html DOM
        let data = getdata();

        // replace each blank
        // data = data.replace(/ +/g,'');

        // replace each span
        // data = data.replace(/\[(.+)\]\((.+)\)/g,'<span data-mean="$2">$1</span>');
        // document.write(data);

        // // match article
        // let article = data.match(/\n# \W+/g);
        // for (let index = 0; index < article.length; index++) {
        //     const element = article[index];
        //     const artdiv = document.createElement('div');
        //     artdiv.setAttribute('class', 'article')
        //     document.querySelector('main').appendChild(artdiv);
        // };

        // // match paragraphs
        // let paragraphs = data.match(/\n# \W+/g);
        // for (let index = 0; index < article.length; index++) {
        //     const element = article[index];
        //     const artdiv = document.createElement('div');
        //     artdiv.setAttribute('class', 'article')
        //     document.querySelector('main').appendChild(artdiv);
        // };
        // build each sentences
        // const sentences = data.match(/(.+)\|(.+)/g);
        // const oridiv = [];
        // const tradiv = [];
        // for (let index = 0; index < sentences.length; index++) {
        //     const element = sentences[index];
        //     oridiv.push('<span data-sentence="'+index+'">'+element.match(/(.+)\|(.+)/)[1]+'</span>');
        //     tradiv.push('<span data-sentence="'+index+'">'+element.match(/(.+)\|(.+)/)[2]+'</span>');
        // };
        // document.querySelector('main').innerHTML = oridiv.join('\r\n');

        // data = data.split(/#{1} (\W+)(?=#{1} )/g);
        // for loop
        // for (let index = 0; index < data.length; index++) {
        //     const line = data[index];
        //     switch (line) {
        //         case /#{1} (.+)*(.+)*/g.test(line):
        //             article = document.createElement('div');
        //             article.setAttribute('class','article');
        //             document.querySelector('header').appendChild(article);
        //             console.log('add ari');
        //             break;
        //         case /#{2}/g.test:
        //             break;
        //         default:
        //             break;
        //     };
        // };

        // split data
        data = data.split('\r\n');
        let titau_count = 0;
        let para_count = 0;
        let sen_count = 0;
        for (let index = 0; index < data.length; index++) {
            element = data[index];
            const titau = /^#{1}\s+(?<title>.+)\*(?<author>.+)\*\s*$/;
            const para = /^#{2}\s+$|^#{2}\s+\*(?<parasubtitle>.+)\*\s*$/;
            const sen = /^(?<ori_span>.+)\|(?<tra_span>.+)$/;
            const mean = /\[([^\[\]\(\)]+)\]\(([^\[\]\(\)]+)\)/g;
            // if (mean.test(element)) {
            //     // mean_span
            //     element = element.replace(mean, '<span data-mean="$2">$1</span>');
            //     // mean_span = document.createElement('span');
            //     // mean_span.setAttribute('data-mean',element.match(mean).groups['meaning']);
            //     // mean_span.innerText = element.match(mean).groups['root'];
            // } else
            if (titau.test(element)) {
                // add article
                titau_count += 1;
                // list append
                alist = document.createElement('a');
                alist.setAttribute('title', element.match(titau).groups['title']);
                alist.setAttribute('href', '#' + element.match(titau).groups['title']);
                alist.innerText = element.match(titau).groups['title'];
                // article
                article = document.createElement('div');
                article.setAttribute('id', element.match(titau).groups['title']);
                article.setAttribute('class', 'article none');
                // title
                title = document.createElement('div');
                title.setAttribute('class', 'title');
                // h1
                h1 = document.createElement('h1');
                h1.innerText = element.match(titau).groups['title'];
                // author
                author = document.createElement('span');
                author.setAttribute('class', 'author');
                author.innerText = element.match(titau).groups['author'];
                // build DOM
                document.querySelector(".article_list").appendChild(alist);
                title.appendChild(h1);
                title.appendChild(author);
                article.appendChild(title);
                document.querySelector('main').appendChild(article);
            } else if (para.test(element)) {
                // add paragraphs
                para_count += 1;
                // paragraphs
                paragraphs = document.createElement('div');
                paragraphs.setAttribute('class', 'paragraphs');
                // passage
                passage = document.createElement('div');
                passage.setAttribute('class', 'passage');
                // passage_header
                passage_header = document.createElement('div');
                passage_header.setAttribute('class', 'passage_header');
                // paragraphs_subtitle
                paragraphs_subtitle = document.createElement('span');
                paragraphs_subtitle.setAttribute('class', 'paragraphs_subtitle');
                if (element.match(para).groups['parasubtitle'] != undefined) {
                    paragraphs_subtitle.innerText = element.match(para).groups['parasubtitle'];
                };
                // btn_relate
                btn_relate = document.createElement('button');
                btn_relate.setAttribute('class', 'btn_relate');
                // btn_relate.innerText = '相關内容';
                btn_relate.innerHTML = '<svg focusable="false" height="24px" viewBox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg"><path d="M20.49,19l-5.73-5.73C15.53,12.2,16,10.91,16,9.5C16,5.91,13.09,3,9.5,3S3,5.91,3,9.5C3,13.09,5.91,16,9.5,16 c1.41,0,2.7-0.47,3.77-1.24L19,20.49L20.49,19z M5,9.5C5,7.01,7.01,5,9.5,5S14,7.01,14,9.5S11.99,14,9.5,14S5,11.99,5,9.5z"></path><path d="M0,0h24v24H0V0z" fill="none"></path></svg>';
                // related
                related = document.createElement('div');
                related.setAttribute('class', 'related');
                // relate_tools
                relate_tools = document.createElement('div');
                relate_tools.setAttribute('class', 'relate_tools');
                // relate_button
                relate_button = document.createElement('button');
                relate_button.setAttribute('class', 'none');
                // relate_content
                relate_content = document.createElement('div');
                relate_content.setAttribute('class', 'relate_content');
                // sentences
                sentences = document.createElement('div');
                sentences.setAttribute('class', 'sentences');
                // original
                original = document.createElement('div');
                original.setAttribute('class', 'original');
                // translation
                translation = document.createElement('div');
                translation.setAttribute('class', 'translation');
                // build DOM
                passage_header.appendChild(paragraphs_subtitle);
                passage_header.appendChild(btn_relate);
                passage.appendChild(passage_header);

                sentences.appendChild(original);
                sentences.appendChild(translation);
                passage.appendChild(sentences);

                relate_tools.appendChild(relate_button);
                related.appendChild(relate_tools);
                related.appendChild(relate_content);

                paragraphs.appendChild(passage);
                paragraphs.appendChild(related);

                article.appendChild(paragraphs);
            } else if (sen.test(element)) {
                // add sentences
                sen_count += 1;
                // ori_mean_span
                mean_span = element.match(sen).groups['ori_span'].replace(mean, '<span data-mean="$2">$1</span>');
                // orignal
                original_span = document.createElement('span');
                original_span.setAttribute('data-sentence', titau_count + '_' + para_count + '_' + sen_count);
                original_span.innerHTML = mean_span;
                // translation
                translation_span = document.createElement('span');
                translation_span.setAttribute('data-sentence', titau_count + '_' + para_count + '_' + sen_count);
                translation_span.innerText = element.match(sen).groups['tra_span'];
                // span
                original.appendChild(original_span);
                translation.appendChild(translation_span);
            }
            // switch (element) {
            //     case /^# (.+)*(.+)*  $/.test(element):
            //         console.log('title${$1}')
            //         break;
            //     default:
            //         console.log(element)
            //         break;
            // };
        };
        // Sentences HighLight
        $('span[data-sentence]').hover(function () {
            $('span[data-sentence="' + $(this).attr('data-sentence') + '"]').addClass('span_hover');
        }, function () {
            $('span[data-sentence="' + $(this).attr('data-sentence') + '"]').removeClass('span_hover');
        });
        // .article_list link to display and hide
        $('.article_list > a').click(function () {
            $('.article').addClass('none');
            $('.article[id="' + $(this).attr('title') + '"]').removeClass('none');
            $('header > h1.page_title').innerText = $(this).attr('title');
        });
    </script>
</body>

</html>
