<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Scroll Down</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="links.js"></script>
    <style>
        body {
            background-color: rgb(0, 0, 0);
            position: relative;
        }

        * {
            margin: 0;
            padding: 0;
        }

        ul,
        li {
            list-style: none;
            display: flex;
        }

        ul {
            flex-wrap: wrap;
        }

        li {
            flex-direction: column;
            margin: 0.375rem;
            position: relative;
            text-align: left;
            max-width: 10.979817rem;
            overflow: hidden;
        }

        li>* {
            cursor: pointer;
            width: 100%;
            -webkit-border-radius: 0.5rem;
            border-radius: 0.5rem;
            margin: auto 0;
        }

        .big_viwer {
            display: none;
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 100%;
            color: rgb(255, 255, 255);
            background-color: rgba(0, 0, 0, 0.75);
            font-family: 'Roboto', Helvetica, Arial, sans-serif;
            font-size: 3rem;
            z-index: 10;
            background-image: url("");
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            transition: all 0.5s;
        }

        .big_viwer div {
            cursor: pointer;
            position: absolute;
            z-index: 20;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            -moz-user-select: none;
        }


        .big_viwer div:hover {
            opacity: 0.75;
        }

        .big_viwer>div[title="close"] {
            top: 0;
            right: 0;
            padding: 0% 0 10% 100%;
        }

        .big_viwer>div[title="left"] {
            margin-top: 15%;
            padding: 45% 40% 100% 5%;
            line-height: 100%;
            left: 0;
        }

        .big_viwer>div[title="right"] {
            margin-top: 15%;
            padding: 45% 5% 100% 40%;
            right: 0;
        }
    </style>
    <script>
        function getnum() {
            return Math.floor(Math.random() * links.length + 1);
        };
        function loadmore(times = 10) {
            let i = 0;
            while (i <= times) {
                const num = getnum()
                const src = links[num];
                if (src.length === 1) {
                    // m3u8
                    // const inli = outli.appendChild(document.createElement("video"));
                } else {
                    // img
                    const outli = document.querySelector("body > ul").appendChild(document.createElement("li"));
                    const inli = outli.appendChild(document.createElement("img"));
                    inli.setAttribute('src', src[0]);
                    inli.setAttribute('alt', num);
                    i += 1;
                };
            };
        };
        //窗口可视范围高度
        var clientHeight = window.innerHeight || Math.min(document.documentElement.clientHeight, document.body.clientHeight);
        window.onscroll = function () {
            //文档内容实际高度（包括超出视窗的溢出部分）
            var scrollHeight = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight);
            //滚动条滚动距离
            var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
            //窗口可视范围高度
            var clientHeight = window.innerHeight || Math.min(document.documentElement.clientHeight, document.body.clientHeight);
            if ((clientHeight + scrollTop) >= (scrollHeight * 0.8)) {
                loadmore();
            };
        };
    </script>
</head>

<body>
    <div class="big_viwer" data-alt="123" data-now="0">
        <div title="close">X</div>
        <div title="left"><</div>
        <div title="right">></div>
    </div>
    <ul>
    </ul>
    <script>
        loadmore(20);
        $('ul').on( "click", 'img', function () {
            const num = this.alt;
            const imgs = links[num];
            $('.big_viwer').css({
                'background-image': 'url("' + imgs[0] + '")',
                'display': 'unset',
            });
            $('.big_viwer').attr('data-alt', num);
            $('.big_viwer').attr('data-now', 0);
            for (let i = 0; i < imgs.length; i++) {
                const element = imgs[i];
                const newimg = new Image();
                newimg.src = element;
            }
        });
        $('.big_viwer').on( "click", 'div[title="close"]', function () {
            $('.big_viwer').css({
                'background-image': 'url("")',
                'display': 'none',
            });
        });
        $('.big_viwer').on( "click", 'div[title="left"]', function () {
            const linkst = links[$('.big_viwer').attr('data-alt')];
            const now = Number($('.big_viwer').attr('data-now'));
            if (now > 0) {
                $('.big_viwer').css({
                    'background-image': 'url("' + linkst[now - 1] + '")',
                });
                $('.big_viwer').attr('data-now', now - 1);
            };
        });
        $('.big_viwer').on( "click", 'div[title="right"]', function () {
            const linkst = links[$('.big_viwer').attr('data-alt')];
            const now = Number($('.big_viwer').attr('data-now'));
            if (now < linkst.length - 1) {
                $('.big_viwer').css({
                    'background-image': 'url("' + linkst[now + 1] + '")',
                });
                $('.big_viwer').attr('data-now', now + 1);
            };
        });
    </script>
</body>

</html>